<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="CodelistGenerator">
<title>03 Generating a codelist for procedures • CodelistGenerator</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="03 Generating a codelist for procedures">
<meta property="og:description" content="CodelistGenerator">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CodelistGenerator</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a01_Introduction_to_CodelistGenerator.html">01 Introduction to CodelistGenerator</a>
    <a class="dropdown-item" href="../articles/a02a_Options_for_CodelistGenerator.html">02 Options for CodelistGenerator (with mock vocabulary)</a>
    <a class="dropdown-item" href="../articles/a02b_Options_for_CodelistGenerator.html">02 Options for CodelistGenerator(with full vocabulary)</a>
    <a class="dropdown-item" href="../articles/a03_CodelistGenerator_extracting_procedure_codes.html">03 Generating a codelist for procedures</a>
    <a class="dropdown-item" href="../articles/a04_codelists_for_medications.html">04 Codelists for medications</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="a03_CodelistGenerator_extracting_procedure_codes_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="a03_CodelistGenerator_extracting_procedure_codes_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="a03_CodelistGenerator_extracting_procedure_codes_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="a03_CodelistGenerator_extracting_procedure_codes_files/datatables-binding-0.23/datatables.js"></script><link href="a03_CodelistGenerator_extracting_procedure_codes_files/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="a03_CodelistGenerator_extracting_procedure_codes_files/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="a03_CodelistGenerator_extracting_procedure_codes_files/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="a03_CodelistGenerator_extracting_procedure_codes_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="a03_CodelistGenerator_extracting_procedure_codes_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>03 Generating a codelist for procedures</h1>
            
      
      
      <div class="d-none name"><code>a03_CodelistGenerator_extracting_procedure_codes.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="creating-a-codelists-for-colonoscopy">Creating a codelists for colonoscopy<a class="anchor" aria-label="anchor" href="#creating-a-codelists-for-colonoscopy"></a>
</h2>
<p>For this vignette we are going to create codelists for identifying a colonoscopy. For this example we are going to generate a candidate codelists looking for codes in either the procedure or measurement domain.</p>
</div>
<div class="section level2">
<h2 id="connecting-to-a-database-with-the-omop-cdm-vocabularies">Connecting to a database with the OMOP CDM vocabularies<a class="anchor" aria-label="anchor" href="#connecting-to-a-database-with-the-omop-cdm-vocabularies"></a>
</h2>
<p>As described previously there are alternative ways to link to the vocabularies. A connection to an existing database can be made like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpostgres.r-dbi.org" class="external-link">RPostgres</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># postgres database connection details</span>
<span class="va">server_dbi</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"server"</span><span class="op">)</span>
<span class="va">user</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"user"</span><span class="op">)</span>
<span class="va">password</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"password"</span><span class="op">)</span>
<span class="va">port</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"port"</span><span class="op">)</span>
<span class="va">host</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"host"</span><span class="op">)</span>

<span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">RPostgres</span><span class="fu">::</span><span class="fu">Postgres</span><span class="op">(</span><span class="op">)</span>,
                dbname <span class="op">=</span> <span class="va">server_dbi</span>,
                port <span class="op">=</span> <span class="va">port</span>,
                host <span class="op">=</span> <span class="va">host</span>,
                user <span class="op">=</span> <span class="va">user</span>,
                password <span class="op">=</span> <span class="va">password</span><span class="op">)</span>

<span class="co"># name of vocabulary schema</span>
<span class="va">vocabulary_database_schema</span><span class="op">&lt;-</span><span class="st">"vocabulary"</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="codelist-from-colonoscopy-and-its-descendants">Codelist from “colonoscopy” and its descendants<a class="anchor" aria-label="anchor" href="#codelist-from-colonoscopy-and-its-descendants"></a>
</h2>
<p>First we can follow the approach of identifying high-level codes and include all their descendants.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">codes_from_descendants</span><span class="op">&lt;-</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">db</span>, 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sql.html" class="external-link">sql</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"SELECT * FROM "</span>,
     <span class="va">vocabulary_database_schema</span>,
     <span class="st">".concept_ancestor"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ancestor_concept_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4249893"</span>, <span class="st">"937652"</span>, <span class="st">"40480729"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"descendant_concept_id"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"concept_id"</span><span class="op">=</span><span class="st">"descendant_concept_id"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">db</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sql.html" class="external-link">sql</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"SELECT * FROM "</span>,
     <span class="va">vocabulary_database_schema</span>,
     <span class="st">".concept"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"concept_id"</span>, <span class="st">"concept_name"</span>, 
         <span class="st">"domain_id"</span>, <span class="st">"vocabulary_id"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">codes_from_descendants</span>,
          rownames<span class="op">=</span><span class="cn">FALSE</span>,
          options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pageLength <span class="op">=</span> <span class="fl">10</span>,
                         lengthMenu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-9a73d8bcb72e074892b7" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9a73d8bcb72e074892b7">{"x":{"filter":"none","vertical":false,"data":[[937652,4305184,4279551,2617223,4117745,40489328,46271320,4124528,37312098,4141953,4047950,40480729,4106988,2617222,4124527,46272000,4017732,40484563,2617208,4147865,46272868,40490832,40488297,4249893,37310523,4145298,2617223,2617222,40480729,2617208],["Diagnostic colonoscopy","Fiberoptic colonoscopy through colostomy","Fiberoptic colonoscopy","Colorectal cancer screening; colonoscopy on individual not meeting criteria for high risk","Therapeutic colonoscopy","Colonoscopy and biopsy of colon","Colonoscopy and dilatation of stricture of colon","Limited colonoscopy","Colonoscopy and fecal microbiota transplantation","Diagnostic endoscopic examination of colonic pouch and biopsy of colonic pouch using colonoscope","Colonoscopy with rigid sigmoidoscope through colotomy","Screening colonoscopy","Fiberoptic colonoscopy with biopsy","Colorectal cancer screening; alternative to g0105, screening colonoscopy, barium enema.","Total colonoscopy","Fluoroscopy guided colonoscopy","Open colonoscopy","Colonoscopy through colostomy with endoscopic biopsy of colon","Colorectal cancer screening; colonoscopy on individual at high risk","Check colonoscopy","Colonoscopy using X-ray guidance","Colonoscopy and tattooing","Colonoscopy and excision of mucosa of colon","Colonoscopy","Colonoscopy using enhanced visualisation single use device","Intraoperative colonoscopy","Colorectal cancer screening; colonoscopy on individual not meeting criteria for high risk","Colorectal cancer screening; alternative to g0105, screening colonoscopy, barium enema.","Screening colonoscopy","Colorectal cancer screening; colonoscopy on individual at high risk"],["Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Measurement","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Measurement","Procedure"],["HCPCS","SNOMED","SNOMED","HCPCS","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","HCPCS","SNOMED","SNOMED","SNOMED","SNOMED","HCPCS","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","HCPCS","HCPCS","SNOMED","HCPCS"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>concept_id<\/th>\n      <th>concept_name<\/th>\n      <th>domain_id<\/th>\n      <th>vocabulary_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"lengthMenu":[10,20,50],"columnDefs":[{"className":"dt-right","targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="generating-a-candidate-codelist-using-codelist-generator">Generating a candidate codelist using Codelist Generator<a class="anchor" aria-label="anchor" href="#generating-a-candidate-codelist-using-codelist-generator"></a>
</h2>
<p>But we can also use CodelistGenerator to generate a candidate codelist for colonoscopy.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CodelistGenerator/">CodelistGenerator</a></span><span class="op">)</span></code></pre></div>
<p>Let’s do a search for a single keyword of “colonoscopy” without any exclusions and not including descendants</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">colonoscopy_codes2</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/get_candidate_codes.html">get_candidate_codes</a></span><span class="op">(</span>keywords<span class="op">=</span><span class="st">"colonoscopy"</span>,
                    domains<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Procedure"</span>,<span class="st">"Measurement"</span><span class="op">)</span>,
                    exclude <span class="op">=</span> <span class="cn">NULL</span>,
                    include_descendants <span class="op">=</span> <span class="cn">FALSE</span>,
                    db<span class="op">=</span><span class="va">db</span>,
                    vocabulary_database_schema <span class="op">=</span>  <span class="va">vocabulary_database_schema</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">colonoscopy_codes2</span>,
          rownames<span class="op">=</span><span class="cn">FALSE</span>,
          options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  pageLength <span class="op">=</span> <span class="fl">10</span>,
  lengthMenu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>,<span class="fl">50</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-b0b86e807d98df9ad8ea" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b0b86e807d98df9ad8ea">{"x":{"filter":"none","vertical":false,"data":[[2617208,2617222,2617223,937652,3028257,3034079,3022145,3018310,3018856,1616452,35610638,4047950,4017732,4124527,4124528,4123906,4106988,4117745,4147865,4145298,4279551,4303376,40484563,40480729,40488297,40489328,40490832,46271320,46272000,46272868,4249893,37310523,37312098,4305184],["Colorectal cancer screening; colonoscopy on individual at high risk","Colorectal cancer screening; alternative to g0105, screening colonoscopy, barium enema.","Colorectal cancer screening; colonoscopy on individual not meeting criteria for high risk","Diagnostic colonoscopy","Colonoscopy study","Colonoscopy Study observation Narrative","Colonoscopy Study observation","Colonoscopy study through stoma","Colonoscopy.thru stoma Study observation","Colonoscopy+US Study","Virtual CT colonoscopy with radiopaque contrast","Colonoscopy with rigid sigmoidoscope through colotomy","Open colonoscopy","Total colonoscopy","Limited colonoscopy","Colonoscopy and extirpation of lesion of colon","Fiberoptic colonoscopy with biopsy","Therapeutic colonoscopy","Check colonoscopy","Intraoperative colonoscopy","Fiberoptic colonoscopy","Virtual CT colonoscopy","Colonoscopy through colostomy with endoscopic biopsy of colon","Screening colonoscopy","Colonoscopy and excision of mucosa of colon","Colonoscopy and biopsy of colon","Colonoscopy and tattooing","Colonoscopy and dilatation of stricture of colon","Fluoroscopy guided colonoscopy","Colonoscopy using X-ray guidance","Colonoscopy","Colonoscopy using enhanced visualisation single use device","Colonoscopy and fecal microbiota transplantation","Fiberoptic colonoscopy through colostomy"],["Procedure","Procedure","Procedure","Procedure","Measurement","Measurement","Measurement","Measurement","Measurement","Measurement","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Measurement","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure","Procedure"],["HCPCS","HCPCS","HCPCS","HCPCS","LOINC","LOINC","LOINC","LOINC","LOINC","LOINC","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED","SNOMED"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>concept_id<\/th>\n      <th>concept_name<\/th>\n      <th>domain_id<\/th>\n      <th>vocabulary_id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"lengthMenu":[10,20,50],"columnDefs":[{"className":"dt-right","targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>What is the difference between this codelist and the one based on descendants?</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">code_comparison</span><span class="op">&lt;-</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">codes_from_descendants</span>  <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type1<span class="op">=</span><span class="st">"Specified codes and descendants"</span><span class="op">)</span>, 
                     <span class="va">colonoscopy_codes2</span>  <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type2<span class="op">=</span><span class="st">"CodelistGenerator"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">type1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">type2</span><span class="op">)</span>,
                     <span class="st">"Both"</span>,
              <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">type1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">type2</span><span class="op">)</span>,
                    <span class="st">"Only specified codes and descendants"</span>,
              <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">type1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">type2</span><span class="op">)</span>,
                     <span class="st">"Only CodelistGenerator"</span>,
                     <span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"type1"</span>,<span class="st">"type2"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Joining, by = c("concept_id", "concept_name", "domain_id",</span>
<span class="co">#&gt; "vocabulary_id")</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">code_comparison</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
type
</th>
<th style="text-align:right;">
n
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Both
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:left;">
Only CodelistGenerator
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
Only specified codes and descendants
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>What are these extra codes picked up by CodelistGenerator?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">code_comparison</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">type</span><span class="op">==</span><span class="st">"Only CodelistGenerator"</span><span class="op">)</span>,
          rownames<span class="op">=</span><span class="cn">FALSE</span>,
          options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  pageLength <span class="op">=</span> <span class="fl">10</span>,
  lengthMenu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>,<span class="fl">50</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-2d43d61a7af45a886d70" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2d43d61a7af45a886d70">{"x":{"filter":"none","vertical":false,"data":[[3028257,3034079,3022145,3018310,3018856,1616452,35610638,4123906,4303376],["Colonoscopy study","Colonoscopy Study observation Narrative","Colonoscopy Study observation","Colonoscopy study through stoma","Colonoscopy.thru stoma Study observation","Colonoscopy+US Study","Virtual CT colonoscopy with radiopaque contrast","Colonoscopy and extirpation of lesion of colon","Virtual CT colonoscopy"],["Measurement","Measurement","Measurement","Measurement","Measurement","Measurement","Procedure","Procedure","Procedure"],["LOINC","LOINC","LOINC","LOINC","LOINC","LOINC","SNOMED","SNOMED","SNOMED"],["Only CodelistGenerator","Only CodelistGenerator","Only CodelistGenerator","Only CodelistGenerator","Only CodelistGenerator","Only CodelistGenerator","Only CodelistGenerator","Only CodelistGenerator","Only CodelistGenerator"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>concept_id<\/th>\n      <th>concept_name<\/th>\n      <th>domain_id<\/th>\n      <th>vocabulary_id<\/th>\n      <th>type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"lengthMenu":[10,20,50],"columnDefs":[{"className":"dt-right","targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>But, what are the codes from specified codes and descendants but not picked up by CodelistGenerator?</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">code_comparison</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">type</span><span class="op">==</span><span class="st">"Only specified codes and descendants"</span><span class="op">)</span>,
          rownames<span class="op">=</span><span class="cn">FALSE</span>,
          options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  pageLength <span class="op">=</span> <span class="fl">10</span>,
  lengthMenu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>,<span class="fl">50</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-f2b88aea5a71f5c44c86" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f2b88aea5a71f5c44c86">{"x":{"filter":"none","vertical":false,"data":[[4141953],["Diagnostic endoscopic examination of colonic pouch and biopsy of colonic pouch using colonoscope"],["Procedure"],["SNOMED"],["Only specified codes and descendants"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>concept_id<\/th>\n      <th>concept_name<\/th>\n      <th>domain_id<\/th>\n      <th>vocabulary_id<\/th>\n      <th>type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"lengthMenu":[10,20,50],"columnDefs":[{"className":"dt-right","targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Edward Burn.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
